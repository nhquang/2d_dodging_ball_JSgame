<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
	<script src="/app.js"></script>
    <title>Breakout</title>
    <style>
    	* { padding: 0; margin: 0; }
    	canvas { background: #eee; display: block; margin: 0 auto; }
    </style>
    
</head>
<body>
	
	<canvas id="myCanvas" width="500" height="400"></canvas>
	<br>
	<div style="margin:auto; color:red; font-size: 50px; text-align:center;">
		Score
	</div>
	<div id="score" style="margin:auto; color:red; font-size: 30px; text-align:center;">
		0
	</div>
	
<script>
    var canvas = document.getElementById("myCanvas");
	var scoreLbl = document.getElementById("score");
    var ctx = canvas.getContext("2d");
	var xCh = canvas.width / 2;
	var yCh =  canvas.width / 2;
	var xRa = canvas.width - 10;
	var yRa = canvas.height - 10;
	var ballRadius = 10;
	var Xd = 0;
	var Yd = 0;
	var xd = -1;
	var yd = -1;
	function keyDown(e){
		switch(e.key){
			case "ArrowUp":
				if(Yd == 0 || Yd == 1) Yd = -1;
				Xd = 0;
				break;
			case "ArrowDown":
				if(Yd == 0 || Yd == -1) Yd = 1;
				Xd = 0;
				break;
			case "ArrowLeft":
				if(Xd == 0 || Xd == 1) Xd = -1;
				Yd = 0;
				break;
			case "ArrowRight":
				if(Xd == 0 || Xd == -1) Xd = 1;
				Yd = 0;
				break;
		}
	}
	document.addEventListener("keydown", keyDown, false);

	var draw = () => {
		ctx.clearRect(0,0,canvas.width,canvas.height);
		drawBall();
		drawRandomBall()
		xCh += Xd; yCh += Yd;
		xRa += xd; yRa += yd;
		if(detectEdgeCollision() || detectBallCollision()){
			alert("You lost!!!");
			clearInterval(interval);   
			document.location.reload();
		}
		if(xRa + ballRadius > canvas.width || xRa - ballRadius < 0) xd *= -1;
		else if (yRa + ballRadius > canvas.height || yRa - ballRadius < 0) yd *= -1;
	}
	var drawBall = () =>{
		ctx.beginPath();
		ctx.arc(xCh, yCh, ballRadius, 0, Math.PI*2);
		ctx.fillStyle = "green";
		ctx.fill();
		ctx.closePath();
	};
	var drawRandomBall = () =>{
		ctx.beginPath();
		ctx.arc(xRa, yRa, ballRadius, 0, Math.PI*2);
		ctx.fillStyle = "red";
		ctx.fill();
		ctx.closePath();
	};
	var detectEdgeCollision = ()=>{
		if(yCh - ballRadius < 0 || yCh + ballRadius > canvas.height) return true;
		if(xCh - ballRadius < 0 || xCh + ballRadius > canvas.width) return true;
		return false;
	};
	var detectBallCollision = ()=>{
		if(yCh - ballRadius == yRa + ballRadius || yCh + ballRadius == yRa - ballRadius) return true;
		if(xCh - ballRadius == xRa + ballRadius || xCh + ballRadius == xRa - ballRadius) return true;
		return false;
	};
    function getRandomArbitrary(min, max) {
		return Math.random() * (max - min) + min;
	}
	var interval = setInterval(draw, 5);
	//draw();
</script>
</body>